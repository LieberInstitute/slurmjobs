<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Submit an array job with a specified set of task IDs — array_submit • slurmjobs</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Submit an array job with a specified set of task IDs — array_submit"><meta property="og:description" content="Given a bash script that specifies the --array sbatch option (that is, an
array job), this function overwrites (temporarily if restore = TRUE) the
script in place and resubmits (when submit = TRUE) the array with the
specified task_ids. If this array was created with job_single, task_ids
may be ommitted and failed tasks are automatically inferred. This function is
intended to help re-run failed tasks of a large array job that was previously
submitted."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slurmjobs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/slurmjobs.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/LieberInstitute/slurmjobs/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Submit an array job with a specified set of task IDs</h1>
    <small class="dont-index">Source: <a href="https://github.com/LieberInstitute/slurmjobs/blob/HEAD/R/array_submit.R" class="external-link"><code>R/array_submit.R</code></a></small>
    <div class="hidden name"><code>array_submit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a bash script that specifies the --array <code>sbatch</code> option (that is, an
array job), this function overwrites (temporarily if <code>restore</code> = TRUE) the
script in place and resubmits (when <code>submit</code> = TRUE) the array with the
specified <code>task_ids</code>. If this array was created with <code>job_single</code>, <code>task_ids</code>
may be ommitted and failed tasks are automatically inferred. This function is
intended to help re-run failed tasks of a large array job that was previously
submitted.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">array_submit</span><span class="op">(</span></span>
<span>  <span class="va">job_bash</span>,</span>
<span>  task_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  submit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  restore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>job_bash</dt>
<dd><p>A <code>character(1)</code> vector with the name of a bash script
in the current working directory.</p></dd>


<dt>task_ids</dt>
<dd><p>An optional numeric vector specifying which (relative) task
IDs to resubmit (e.g. c(1, 4, 6)). If NULL, the task IDs will be inferred
by scraping the log file for the job ID for the array job as originally
submitted, and using <code><a href="job_report.html">job_report()</a></code> to pull failed task IDs</p></dd>


<dt>submit</dt>
<dd><p>A <code>logical(1)</code> vector determining whether to actually submit
the tasks or not using <code>qsub</code>.</p></dd>


<dt>restore</dt>
<dd><p>A <code>logical(1)</code> vector determining whether to restore the
script to the original state.</p></dd>


<dt>verbose</dt>
<dd><p>A <code>logical(1)</code> vector specifying whether to print details
about how failed tasks were determined (applicable when <code>task_ids</code> is NULL).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The path to <code>job_bash</code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Leonardo Collado-Torres</p>
<p>Nicholas J. Eagles</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Choose a script name</span></span></span>
<span class="r-in"><span><span class="va">job_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"array_submit_example_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create an array job on the temporary directory</span></span></span>
<span class="r-in"><span><span class="fu"><a href="with_wd.html">with_wd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co">## Create an array job script to use for this example</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="job_single.html">job_single</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        name <span class="op">=</span> <span class="va">job_name</span>,</span></span>
<span class="r-in"><span>        create_shell <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>        task_num <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Now we can submit the job for a set of task IDs (or omit 'task_ids'</span></span></span>
<span class="r-in"><span>    <span class="co">## to automatically grab those same failed task IDs)</span></span></span>
<span class="r-in"><span>    <span class="fu">array_submit</span><span class="op">(</span></span></span>
<span class="r-in"><span>        job_bash <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">job_name</span>, <span class="st">".sh"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        task_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">67</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        submit <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-10-06 16:28:50.973317 creating the logs directory at:  logs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-10-06 16:28:50.974784 creating the shell file array_submit_example_2023-10-06.sh</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To submit the job use: sbatch array_submit_example_2023-10-06.sh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "array_submit_example_2023-10-06.sh"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nicholas J. Eagles.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

